<!DOCTYPE html>
<html>
<head>
  <title>eatC - Login</title>
  <link rel="stylesheet" type="text/css" href="st.css">
</head>
<body>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
  <script>
    const firebaseConfig = {
          apiKey: "AIzaSyAhsLFXuGPA_uP42iTcUSR1x4sZyhWCbzU",
          authDomain: "eatc-fd3bd.firebaseapp.com",
          projectId: "eatc-fd3bd",
          storageBucket: "eatc-fd3bd.appspot.com",
          messagingSenderId: "1053136450043",
          appId: "1:1053136450043:web:751c9fcf12c9a408719b5e"
        };
        firebase.initializeApp(firebaseConfig);
  </script>
  <div class="login-box">
    <h1>eatC</h1>
    <form id="formlogin">
      <div class="textbox">
        <input id="mail" type="text" placeholder="Email" name="email" required>
      </div>
      <div class="textbox">
        <input id="passsignin" type="password" placeholder="Password" name="password" required>
      </div>
      <input onclick="signin()" class="btn0" type="submit" value="Sign in">
      <input class="btn1" type="submit" onclick="loginWithGoogle()" value="Sign in with google">
      <p class="signup-link">Don't have an account? <a href="../signup/signup.html">Sign up</a></p>
    </form>
  </div>

    <!-- <script defer>
        let user = firebase.auth().currentUser;
        firebase.auth().onAuthStateChanged((user)=>{
            const usernameElement = document.getElementById('username');
            usernameElement.innerHTML=user.displayName
            document.getElementById('dp').src=user.photoURL;
        })
// const displayName = user.displayName;

// Get the reference to the HTML element

// Update the content of the element with the user name
// usernameElement.innerHTML = displayName;
        function showPopup(name){
            document.getElementById('popup').showModal();
            document.getElementById('popupname').innerHTML=name
        }
    </script>
    
</body>
</html>
  </dialog> -->
  <script>
    var provider = new firebase.auth.GoogleAuthProvider();
    function loginWithGoogle() {
    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
      var provider = new firebase.auth.GoogleAuthProvider();
      firebase.auth().signInWithPopup(provider)
        .then((result) => {
          window.location.href = "../eatchome.html";
          // document.getElementById("main").showModal();
        })
        .catch((error) => {
          // Handle sign-in errors
          var errorCode = error.code;
          var errorMessage = error.message;
          console.error(errorCode, errorMessage);
        });
      }
      const  email=document.getElementById("mail");
      const  password=document.getElementById("passsignin");
      document.getElementById('formlogin').addEventListener('submit', function(event) {
      event.preventDefault(); 
            console.log("😍");
          firebase.auth().signInWithEmailAndPassword(email.value, password.value)
          .then((userCredential) => {
            // Signed in
            var user = userCredential.user;
            window.location.href="../eatchome.html"
            // ...
          })
          .catch((error) => {
            alert(error.message);
            // var errorCode = error.code;
            // var errorMessage = error.message;
          });
    });
  </script>
</body>
</html>